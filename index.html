<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="UNIGARA - Plataforma de sugerencias universitarias"
    />
    <link rel="icon" type="image/png" href="u-icon.png" />

    <title>UNIGARA - Mejora tu universidad</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script src="app.js" defer></script>
  </head>
  <body>
    <div class="container">
      <header class="header" role="banner">
        <a href="index.html" class="logo">UNIGARA</a>
        <div class="logo-icons">
          <div class="u-logo" aria-hidden="true">U</div>
          <div class="logo-square" aria-hidden="true"></div>
          <button class="menu-icon" aria-label="Abrir men칰" id="menuToggle">
            <span class="menu-line"></span>
            <span class="menu-line"></span>
            <span class="menu-line"></span>
          </button>
        </div>

        <!-- Men칰 desplegable -->
        <nav class="dropdown-menu" id="dropdownMenu">
          <ul>
            <li><a href="index.html" class="active">Inicio</a></li>
            <li><a href="sugerencias.html">Nueva sugerencia</a></li>
            <li><a href="#">Mi perfil</a></li>
            <li><a href="#">Configuraci칩n</a></li>
            <li><a href="#">Cerrar sesi칩n</a></li>
          </ul>
        </nav>
      </header>

      <main class="content" role="main">
        <section class="main-message" aria-labelledby="welcome-heading">
          <h1 id="welcome-heading">Bienvenido a UNIGARA</h1>
          <p>
            Tu plataforma para mejorar la universidad. Vota por las mejores
            propuestas o crea las tuyas.
          </p>
        </section>
        <!-- A침adir esto despu칠s de la secci칩n "main-message" en index.html -->
        <div class="search-container">
          <input
            type="text"
            class="search-bar"
            id="proposalSearch"
            placeholder="Buscar propuestas..."
          />
          <div class="search-icon">游댌</div>
        </div>

        <script>
          // A침adir al final de app.js
          document.addEventListener("DOMContentLoaded", function () {
            const searchInput = document.getElementById("proposalSearch");
            if (searchInput) {
              searchInput.addEventListener("input", function () {
                const searchTerm = this.value.toLowerCase();
                const proposals = document.querySelectorAll(".proposal-item");

                proposals.forEach((proposal) => {
                  const title = proposal
                    .querySelector(".proposal-text")
                    .textContent.toLowerCase();
                  const description = proposal
                    .querySelector(".proposal-description")
                    .textContent.toLowerCase();

                  if (
                    title.includes(searchTerm) ||
                    description.includes(searchTerm)
                  ) {
                    proposal.style.display = "flex";
                  } else {
                    proposal.style.display = "none";
                  }
                });
              });
            }
          });
        </script>
        <!-- A침adir despu칠s del search-container en index.html -->
        <div class="filter-controls">
          <div class="filter-group">
            <label class="filter-label">Filtrar por categor칤a</label>
            <select id="categoryFilter" class="filter-select">
              <option value="all">Todas las categor칤as</option>
              <option value="facilities">Instalaciones</option>
              <option value="academic">Acad칠mico</option>
              <option value="services">Servicios</option>
              <option value="other">Otro</option>
            </select>
          </div>
          <div class="filter-group">
            <label class="filter-label">Ordenar por</label>
            <select id="sortFilter" class="filter-select">
              <option value="votes">M치s votados</option>
              <option value="date">M치s recientes</option>
            </select>
          </div>
        </div>

        <script>
          // A침adir al final de app.js
          document.addEventListener("DOMContentLoaded", function () {
            // Asignar categor칤as a las propuestas (simulado)
            const proposalCategories = {
              1: "facilities",
              2: "services",
              3: "facilities",
              4: "academic",
            };

            // Asignar fechas simuladas a las propuestas
            const proposalDates = {
              1: new Date("2025-04-10"),
              2: new Date("2025-04-05"),
              3: new Date("2025-04-12"),
              4: new Date("2025-04-01"),
            };

            // Configurar atributos de datos para cada propuesta
            document.querySelectorAll(".proposal-item").forEach((item) => {
              const id = item.getAttribute("data-proposal-id");
              item.setAttribute(
                "data-category",
                proposalCategories[id] || "other"
              );
              item.setAttribute(
                "data-date",
                proposalDates[id]?.toISOString() || new Date().toISOString()
              );
            });

            // Filtrado por categor칤a
            const categoryFilter = document.getElementById("categoryFilter");
            if (categoryFilter) {
              categoryFilter.addEventListener("change", filterProposals);
            }

            // Ordenaci칩n
            const sortFilter = document.getElementById("sortFilter");
            if (sortFilter) {
              sortFilter.addEventListener("change", filterProposals);
            }

            function filterProposals() {
              const selectedCategory = categoryFilter.value;
              const sortBy = sortFilter.value;
              const proposals = Array.from(
                document.querySelectorAll(".proposal-item")
              );
              const proposalList = document.querySelector(".proposal-list");

              // Filtrar por categor칤a
              const filteredProposals = proposals.filter((proposal) => {
                if (selectedCategory === "all") return true;
                return (
                  proposal.getAttribute("data-category") === selectedCategory
                );
              });

              // Ordenar
              filteredProposals.sort((a, b) => {
                if (sortBy === "votes") {
                  const votesA = parseInt(
                    a
                      .querySelector(".proposal-score")
                      .getAttribute("data-votes")
                  );
                  const votesB = parseInt(
                    b
                      .querySelector(".proposal-score")
                      .getAttribute("data-votes")
                  );
                  return votesB - votesA;
                } else if (sortBy === "date") {
                  const dateA = new Date(a.getAttribute("data-date"));
                  const dateB = new Date(b.getAttribute("data-date"));
                  return dateB - dateA;
                }
                return 0;
              });

              // Actualizar la numeraci칩n
              filteredProposals.forEach((proposal, index) => {
                proposal.querySelector(".proposal-number").textContent =
                  index + 1;
              });

              // Limpiar y re-renderizar
              proposalList.innerHTML = "";
              filteredProposals.forEach((proposal) => {
                proposalList.appendChild(proposal);
                proposal.style.display = "flex";
              });
            }
          });
        </script>

        <section class="ranking" aria-labelledby="ranking-heading">
          <h2 id="ranking-heading">Ranking de Sugerencias</h2>

          <div class="proposal-list">
            <!-- Item 1 -->
            <article class="proposal-item" data-proposal-id="1">
              <div class="proposal-number">1</div>
              <div class="proposal-content">
                <h3 class="proposal-text">Sillas en cafeter칤a</h3>
                <p class="proposal-description">
                  Renovaci칩n de mobiliario en cafeter칤a central
                </p>
              </div>
              <div class="proposal-stats">
                <div class="proposal-score" data-votes="103">103</div>
                <div class="progress-container" title="100% completado">
                  <div class="progress-bar" style="width: 100%"></div>
                </div>
                <button
                  class="vote-button"
                  aria-label="Votar por esta propuesta"
                >
                  <span class="vote-icon">+</span>
                </button>
              </div>
            </article>

            <!-- Item 2 -->
            <article class="proposal-item" data-proposal-id="2">
              <div class="proposal-number">2</div>
              <div class="proposal-content">
                <h3 class="proposal-text">Renovaci칩n de c치maras</h3>
                <p class="proposal-description">
                  Sistema de vigilancia actualizado para mayor seguridad
                </p>
              </div>
              <div class="proposal-stats">
                <div class="proposal-score" data-votes="75">75</div>
                <div class="progress-container" title="73% completado">
                  <div class="progress-bar" style="width: 73%"></div>
                </div>
                <button
                  class="vote-button"
                  aria-label="Votar por esta propuesta"
                >
                  <span class="vote-icon">+</span>
                </button>
              </div>
            </article>

            <!-- Item 3 -->
            <article class="proposal-item" data-proposal-id="3">
              <div class="proposal-number">3</div>
              <div class="proposal-content">
                <h3 class="proposal-text">Ventilaci칩n en cancha</h3>
                <p class="proposal-description">
                  Mejorar sistema de aire en pabell칩n deportivo
                </p>
              </div>
              <div class="proposal-stats">
                <div class="proposal-score" data-votes="69">69</div>
                <div class="progress-container" title="67% completado">
                  <div class="progress-bar" style="width: 67%"></div>
                </div>
                <button
                  class="vote-button"
                  aria-label="Votar por esta propuesta"
                >
                  <span class="vote-icon">+</span>
                </button>
              </div>
            </article>

            <!-- Item 4 (Nuevo) -->
            <article class="proposal-item" data-proposal-id="4">
              <div class="proposal-number">4</div>
              <div class="proposal-content">
                <h3 class="proposal-text">WiFi biblioteca</h3>
                <p class="proposal-description">
                  Mejorar la cobertura en salas de estudio
                </p>
              </div>
              <div class="proposal-stats">
                <div class="proposal-score" data-votes="58">58</div>
                <div class="progress-container" title="56% completado">
                  <div class="progress-bar" style="width: 56%"></div>
                </div>
                <button
                  class="vote-button"
                  aria-label="Votar por esta propuesta"
                >
                  <span class="vote-icon">+</span>
                </button>
              </div>
            </article>
          </div>
        </section>
      </main>

      <a
        href="sugerencias.html"
        class="floating-button"
        aria-label="Crear nueva sugerencia"
        >+</a
      >

      <nav class="navigation" role="navigation">
        <a
          href="index.html"
          class="nav-icon"
          aria-label="Inicio"
          title="Inicio"
        >
          <div class="home-icon active"></div>
        </a>
        <a href="#" class="nav-icon" aria-label="Noticias" title="Noticias">
          <div class="news-icon"></div>
        </a>
        <a
          href="#"
          class="nav-icon"
          aria-label="Men칰 de aplicaciones"
          title="Aplicaciones"
        >
          <div class="grid-icon">
            <div class="grid-item"></div>
            <div class="grid-item"></div>
            <div class="grid-item"></div>
            <div class="grid-item"></div>
          </div>
        </a>
        <a
          href="#"
          class="nav-icon"
          aria-label="Notificaciones"
          title="Notificaciones"
        >
          <div class="notification-icon"></div>
          <span class="notification-badge">2</span>
        </a>
      </nav>
    </div>
  </body>
</html>
